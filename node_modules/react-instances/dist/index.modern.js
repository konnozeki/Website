import{transform as e,get as t,set as n,isObject as r,has as o,pick as c,isEqual as s,isEmpty as a}from"lodash";import{useState as u,useEffect as i,useRef as f}from"react";var l={INSTANCES:Symbol("instances"),OBSERVERS:Symbol("observers")};function p(e){return e[l.INSTANCES]=new Map,e.getInstances=function(){return e[l.INSTANCES]},e.hasInstance=function(t){return e.getInstances().has(t)&&e.getInstances().get(t)},e.getInstance=function(t){return e.getInstances().get(t)},e.addInstance=function(t,n){return e.getInstances().set(t,n)},e.removeInstance=function(t){return e.getInstances().delete(t)},e}function v(o,c,s){return void 0===s&&(s=[]),typeof o!=typeof c?o:e(o,function(e,o,a){O.isEqual(o,t(c,a),s)||n(e,a,r(o)&&r(t(c,a))?v(o,t(c,a),s.concat(a)):o)},{})}function g(e){return e[l.OBSERVERS]=new Map,e.getObservers=function(){return e[l.OBSERVERS]},e.hasObserver=function(t){return e.getObservers().has(t)},e.getObserver=function(t){return e.hasObserver(t)?e.getObservers().get(t):new Map},e.addObserver=function(t,n){e.hasObserver(t)||e.getObservers().set(t,new Map);var r=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)});return e.getObserver(t).set(r,n),r},e.notifyObservers=function(t,n){for(var r=arguments.length,o=new Array(r>2?r-2:0),c=2;c<r;c++)o[c-2]=arguments[c];var s=o.length>1?Object.assign.apply(Object,[{}].concat(o)):o[0];e.getObserver(t).forEach(function(e){return e(n,s)})},e.removeObserver=function(t,n){e.hasObserver(t)&&e.getObserver(t).delete(n)},e}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e,t){return void 0===t&&(t="name"),p(function(e){var n,r;function o(n){var r;return r=e.call(this,n)||this,o.addInstance(r.props[t],function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r)),r}return r=e,(n=o).prototype=Object.create(r.prototype),n.prototype.constructor=n,b(n,r),o.prototype.componentWillUnmount=function(){o.removeInstance(this.props[t])},o}(e))}function O(e,n,r,s){var a=u(s),f=a[0],l=a[1];return i(function(){var s=e.addObserver(n,function(e,n){if(r){var s="string"==typeof r;(s?o(e,r):r.some(function(t){return o(e,t)}))&&l((s?t:c)(n,r))}else O.isEqual(n,f)||l(n)});return function(){e.removeObserver(n,s)}},[]),f}function h(e){O.isEqual=e}function d(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];var c=f();i(function(){var n=r.length>1?Object.assign.apply(Object,[{}].concat(r)):r[0],o=v(n,c.current);a(o)||e.notifyObservers.apply(e,[t,o].concat(r)),c.current=n},[].concat(r))}function m(e){var t=p(e);return new Proxy(t,{get:Reflect.get,set:Reflect.set,apply:function(e,n,r){var o=r[0],c=r.slice(1),s=Reflect.apply(e,n,c);return E(t,o,s),s}})}function I(e){return g(e),new Proxy(e,{get:Reflect.get,set:Reflect.set,apply:function(t,n,r){var o=r[0],c=r.slice(1),s=Reflect.apply(t,n,c);return d(e,o,s),s}})}function R(e){return p(e),g(e),new Proxy(e,{get:Reflect.get,set:Reflect.set,apply:function(t,n,r){var o=r[0],c=r.slice(1),s=Reflect.apply(t,n,c);return E(e,o,s),d(e,o,s),s}})}function E(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];e.addInstance(t,r.length>1?Object.assign.apply(Object,[{}].concat(r)):r[0]),i(function(){return function(){e.removeInstance(t)}},[])}O.isEqual=s;export{p as manageInstances,g as observable,h as setEqual,l as symbols,E as useInstanceManage,O as useObserver,d as useObserversNotify,m as withHookInstanceManage,R as withHookManage,I as withHookObserversNotify,y as withInstanceManage};
//# sourceMappingURL=index.modern.js.map
