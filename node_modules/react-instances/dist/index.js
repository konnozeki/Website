var e=require("lodash"),t=require("react"),n={INSTANCES:Symbol("instances"),OBSERVERS:Symbol("observers")};function r(e){return e[n.INSTANCES]=new Map,e.getInstances=function(){return e[n.INSTANCES]},e.hasInstance=function(t){return e.getInstances().has(t)&&e.getInstances().get(t)},e.getInstance=function(t){return e.getInstances().get(t)},e.addInstance=function(t,n){return e.getInstances().set(t,n)},e.removeInstance=function(t){return e.getInstances().delete(t)},e}function s(t,n,r){return void 0===r&&(r=[]),typeof t!=typeof n?t:e.transform(t,function(t,o,c){a.isEqual(o,e.get(n,c),r)||e.set(t,c,e.isObject(o)&&e.isObject(e.get(n,c))?s(o,e.get(n,c),r.concat(c)):o)},{})}function o(e){return e[n.OBSERVERS]=new Map,e.getObservers=function(){return e[n.OBSERVERS]},e.hasObserver=function(t){return e.getObservers().has(t)},e.getObserver=function(t){return e.hasObserver(t)?e.getObservers().get(t):new Map},e.addObserver=function(t,n){e.hasObserver(t)||e.getObservers().set(t,new Map);var r=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)});return e.getObserver(t).set(r,n),r},e.notifyObservers=function(t,n){for(var r=arguments.length,s=new Array(r>2?r-2:0),o=2;o<r;o++)s[o-2]=arguments[o];var c=s.length>1?Object.assign.apply(Object,[{}].concat(s)):s[0];e.getObserver(t).forEach(function(e){return e(n,c)})},e.removeObserver=function(t,n){e.hasObserver(t)&&e.getObserver(t).delete(n)},e}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(n,r,s,o){var c=t.useState(o),u=c[0],i=c[1];return t.useEffect(function(){var t=n.addObserver(r,function(t,n){if(s){var r="string"==typeof s;(r?e.has(t,s):s.some(function(n){return e.has(t,n)}))&&i((r?e.get:e.pick)(n,s))}else a.isEqual(n,u)||i(n)});return function(){n.removeObserver(r,t)}},[]),u}function u(n,r){for(var o=arguments.length,c=new Array(o>2?o-2:0),a=2;a<o;a++)c[a-2]=arguments[a];var u=t.useRef();t.useEffect(function(){var t=c.length>1?Object.assign.apply(Object,[{}].concat(c)):c[0],o=s(t,u.current);e.isEmpty(o)||n.notifyObservers.apply(n,[r,o].concat(c)),u.current=t},[].concat(c))}function i(e,n){for(var r=arguments.length,s=new Array(r>2?r-2:0),o=2;o<r;o++)s[o-2]=arguments[o];e.addInstance(n,s.length>1?Object.assign.apply(Object,[{}].concat(s)):s[0]),t.useEffect(function(){return function(){e.removeInstance(n)}},[])}a.isEqual=e.isEqual,exports.manageInstances=r,exports.observable=o,exports.setEqual=function(e){a.isEqual=e},exports.symbols=n,exports.useInstanceManage=i,exports.useObserver=a,exports.useObserversNotify=u,exports.withHookInstanceManage=function(e){var t=r(e);return new Proxy(t,{get:Reflect.get,set:Reflect.set,apply:function(e,n,r){var s=r[0],o=r.slice(1),c=Reflect.apply(e,n,o);return i(t,s,c),c}})},exports.withHookManage=function(e){return r(e),o(e),new Proxy(e,{get:Reflect.get,set:Reflect.set,apply:function(t,n,r){var s=r[0],o=r.slice(1),c=Reflect.apply(t,n,o);return i(e,s,c),u(e,s,c),c}})},exports.withHookObserversNotify=function(e){return o(e),new Proxy(e,{get:Reflect.get,set:Reflect.set,apply:function(t,n,r){var s=r[0],o=r.slice(1),c=Reflect.apply(t,n,o);return u(e,s,c),c}})},exports.withInstanceManage=function(e,t){return void 0===t&&(t="name"),r(function(e){var n,r;function s(n){var r;return r=e.call(this,n)||this,s.addInstance(r.props[t],function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r)),r}return r=e,(n=s).prototype=Object.create(r.prototype),n.prototype.constructor=n,c(n,r),s.prototype.componentWillUnmount=function(){s.removeInstance(this.props[t])},s}(e))};
//# sourceMappingURL=index.js.map
